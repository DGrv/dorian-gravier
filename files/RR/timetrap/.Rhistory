data.table(read.csv(rP("file:///C:/Users/doria/Downloads/gdrive/RR/2025/20250419__GP_Osterhas/Sample_data/VIVI_Elite.csv")))
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
# Sys.setlocale('LC_ALL', 'German')
source(paste0(rootpath, 'BM_Function_v01.r'), encoding='utf-8')
data.table(read.csv(rP("file:///C:/Users/doria/Downloads/gdrive/RR/2025/20250419__GP_Osterhas/Sample_data/VIVI_Elite.csv")))
data <- data.table(read.csv(rP("file:///C:/Users/doria/Downloads/gdrive/RR/2025/20250419__GP_Osterhas/Sample_data/VIVI_Elite.csv")))
u(data$RD_Bib)
data
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
Sys.setlocale('LC_ALL', 'German')
source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")
# GP Osterhas -------------------------------------------------------------
# check max lap
steps <- 10
test <- c()
for(i in 1:(110/steps)) {
temp <- paste0('format(Dmax("[Lap',(i*steps-(steps-1)):(i*steps),'.Decimal]+1";"[Contest2Race]="&[Contest2Race]);"hh:mm:ss")', collapse = "")
temp <- substr(temp, 1, nchar(temp) - 6)
test <- c(test, temp)
}
writeClipboard(test)
# check max lap
steps <- 10
test <- c()
for(i in 1:(20/steps)) {
temp <- paste0('"',(i*steps-(steps-1)):(i*steps), '-"&format(Dmax("[Lap',(i*steps-(steps-1)):(i*steps),'.Decimal]+1";"[Contest2Race]="&[Contest2Race]);"hh:mm:ss")&[lf]&', collapse = "")
temp <- substr(temp, 1, nchar(temp) - 6)
test <- c(test, temp)
}
writeClipboard(test)
steps <- 10
test <- c()
for(i in 1:(110/steps)) {
temp <- paste0('"',(i*steps-(steps-1)):(i*steps), '-"&format(Dmax("[Lap',(i*steps-(steps-1)):(i*steps),'.Decimal]+1";"[Contest2Race]="&[Contest2Race]);"hh:mm:ss")&[lf]&', collapse = "")
temp <- substr(temp, 1, nchar(temp) - 6)
test <- c(test, temp)
}
writeClipboard(test)
steps <- 10
test <- c()
for(i in 1:(110/steps)) {
temp <- paste0('"',(i*steps-(steps-1)):(i*steps), '-"&format(Dmax("[Lap',(i*steps-(steps-1)):(i*steps),'.Decimal]+1";"[Contest2Race]="&[Contest2Race]);"hh:mm:ss")&[lf]&', collapse = "")
temp <- substr(temp, 1, nchar(temp) - 6)
test <- c(test, temp)
}
writeClipboard(test)
test <- c()
for(i in 1:(110/steps) ) {
temp <- paste0("L",(i*steps-(steps-1)), "-", (i*steps), "-P")
test <- c(test, temp)
}
test
writeClipboard(test)
test <- c()
for(i in 1:(110/steps) ) {
temp <- paste0("L",(i*steps-(steps-1)), "-", (i*steps))
test <- c(test, temp)
}
test
writeClipboard(test)
# check max lap
steps <- 10
test <- c()
for(i in 1:(110/steps)) {
temp <- paste0('"',(i*steps-(steps-1)):(i*steps), '-"&format(Dmax("[LapAF',(i*steps-(steps-1)):(i*steps),'.Decimal]+1";"[Contest2Race]="&[Contest2Race]);"hh:mm:ss")&[lf]&', collapse = "")
temp <- substr(temp, 1, nchar(temp) - 6)
test <- c(test, temp)
}
writeClipboard(test)
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
Sys.setlocale('LC_ALL', 'German')
source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")
readClipboard()
copdat <- read.delim("clipboard")
read.delim("clipboard")
read.table(file = "clipboard", sep = "\t", header=TRUE)
data <- data.table(read.delim("clipboard"))
data[, .N, .(LastName, FirstName)]
data[, .N, .(LastName, FirstName)][N>1]
# setup
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
Sys.setlocale('LC_ALL', 'German')
source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")
ToDToDecimal("17:37:30")
ToDToDecimal("17:37:30")
# setup
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
Sys.setlocale('LC_ALL', 'German')
source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")
library(lubridate)
library(hms)
ToDToDecimal("17:37:30")
time <- ToDToDecimal("17:37:30")
bib <- c("8","18","67","11","23","56")
p0("https://api.raceresult.com/316629/GKC9UPV2RDNF8LXVJSVLXT7BDP08XB0L"&"?bib=", bib, "&time=", time)
p0("https://api.raceresult.com/316629/GKC9UPV2RDNF8LXVJSVLXT7BDP08XB0L?bib=", bib, "&time=", time)
time <- ToDToDecimal("17:35:11")
bib <- c("8","18","67","11","23","56")
p0("https://api.raceresult.com/316629/GKC9UPV2RDNF8LXVJSVLXT7BDP08XB0L?bib=", bib, "&time=", time)
t <- p0("https://api.raceresult.com/316629/GKC9UPV2RDNF8LXVJSVLXT7BDP08XB0L?bib=", bib, "&time=", time)
writeClipboard(t)
time <- ToDToDecimal("17:35:20")
bib <- c("8","18","67","11","23","56")
t <- p0("https://api.raceresult.com/316629/GKC9UPV2RDNF8LXVJSVLXT7BDP08XB0L?bib=", bib, "&time=", time)
writeClipboard(t)
t <- p0("https://api.raceresult.com/316629/RPQA6LDZJSBY9AIHPFAIAZPKGDCRFHIB?bib=",bib, "&fieldname=Lap81Minus&value=1")
writeClipboard(t)
t <- p0("https://api.raceresult.com/316629/RPQA6LDZJSBY9AIHPFAIAZPKGDCRFHIB?bib=",bib, "&fieldname=Lap81Minus&value=1")
writeClipboard(t)
url <- "https://api.raceresult.com/315977/4TV4B6CVD10OOGLG5KYUUWZ30GFO2PYA"
fromJson(url)
fromJSON(url)
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
# Sys.setlocale('LC_ALL', 'German')
suppressWarnings(suppressMessages(source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")))
url <- "https://api.raceresult.com/315977/4TV4B6CVD10OOGLG5KYUUWZ30GFO2PYA"
fromJSON(url)
results <- data.table(jsonlite::fromJSON(url(url), flatten = TRUE))
results
url(url)
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
# Sys.setlocale('LC_ALL', 'German')
suppressWarnings(suppressMessages(source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")))
url <- "https://api.raceresult.com/315977/4TV4B6CVD10OOGLG5KYUUWZ30GFO2PYA"
data <- data.table(jsonlite::fromJSON(url(url), flatten = TRUE))
setnames(data, names(data), c("Contest","Firstname","Lastname","Nation","UCI_ID"))
data
data[, .N, UCI_ID][N>1]
data[UCI_ID != "", .N, UCI_ID][N>1]
data[UCI_ID %IN% data[UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID]
data[UCI_ID %in% data[UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID]
data[UCI_ID %in% data[UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID][order(UCI_ID)]
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
# Sys.setlocale('LC_ALL', 'German')
suppressWarnings(suppressMessages(source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")))
url <- "https://api.raceresult.com/315977/4TV4B6CVD10OOGLG5KYUUWZ30GFO2PYA"
data <- data.table(jsonlite::fromJSON(url(url), flatten = TRUE))
setnames(data, names(data), c("Contest","Firstname","Lastname","Nation","UCI_ID", "Bib"))
data[UCI_ID %in% data[UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID][order(UCI_ID)]
data[Contest != 100][UCI_ID %in% data[UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID][order(UCI_ID)]
data[Contest != 100][UCI_ID %in% data[UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID][order(UCI_ID, Contest)]
data[Contest != 100][UCI_ID %in% data[Contest != 100][UCI_ID != "", .N, UCI_ID][N>1]$UCI_ID][order(UCI_ID, Contest)]
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
Sys.setlocale('LC_ALL', 'German')
source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")
# library(RecordLinkage)
library(stringdist)
data <- readAll(rP("file:///C:/Users/doria/Downloads/gdrive/RR/2025/2025______SwissBikeCup/BU/rr_backup_Skoda_Swiss_Bike_Cup_2025_20250507-100402/participants.csv"))
data
data[, Name := p0(Lastname, " ", Firstname)]
data <- data[, .(Contest, Name)]
lcontest <- u(data$Contest)
all <- data.table()
for(i in seq_along(lcontest)) {
data2 <- data[Contest == lcontest[i]]
data3 <- data.table(expand.grid(data2$Name, data2$Name))
data3[, Var1 := as.character.factor(Var1)]
data3[, Var2 := as.character.factor(Var2)]
data3[, dist := stringsim(Var1, Var2)]
data3 <- data3[dist != 1][dist > 0.5]
data3 <- data3[order(-dist)]
data3[, Contest := lcontest[i]]
all <- rbind(all, data3)
all <- all[order(-dist)]
}
all[1:50]
# setup
rm(list = ls())
rootpath <- 'C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/R/'
suppressWarnings(suppressMessages(source(paste0(rootpath, "BM_Function_v01.r"), encoding="utf-8")))
wd <- rP("file:///C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/configBU/timetrap/")
wd2 <- rP("file:///C:/Users/doria/Downloads/GitHub/dorian.gravier.github.io/files/RR/timetrap")
setwd(wd)
ll <- list.files(wd, "csv")
ll <- ll[rev(order(ll))]
lf <- ll[1]
data <- data.table(read.csv(lf, encoding = "utf-8"))
data[, start2 := as.POSIXct(start, format = "%Y-%m-%d %H:%M:%S")]
data[, end2 := as.POSIXct(end, format = "%Y-%m-%d %H:%M:%S")]
data[, EventDay := F]
data[note %like% " EVENT", EventDay := T]
data[EventDay==T, nDays := as.numeric(difftime(end2, start2, units = "days"))]
data[, nDays2 := ifelse(nDays<1, ceiling(nDays), ceiling(nDays*2)/2)]
data[EventDay==F, nHours := as.numeric(difftime(end2, start2, units = "hours"))]
dataE <- data[EventDay==T, .(SumDays = sum(nDays2), StartDay = format(min(start2), "%Y-%m-%d"), EndDay = format(max(start2), "%Y-%m-%d")), note]
dataE[, note := gsub(" EVENT", "", note)]
TTDays <- sum(dataE$SumDays)
cat(red("Number of Event days: "), TTDays, "\n")
data2 <- data[EventDay==F, .(SumHours = sum(nHours)), note]
data2 <- dtjoin(data2, dataE, type = "full")
data2[, OnSite := ifelse(is.na(SumDays)==T, F, T)]
data2[is.na(SumHours), SumHours := 0]
a <- ggplot(data2, aes(note, SumHours, fill = OnSite))+
geom_bar(stat="identity")+
turnXaxis()+
geom_text(aes(label=p0(round(SumHours), "h", ifelse(is.na(SumDays)==F, p0(" - ", SumDays, "d"), ""))), hjust = -0.1, size = 3)+
coord_flip()+
orderX(data2[order(SumHours)]$note)+
xlab("Event")+
ylim(c(0, max(data2$SumHours)*1.3))+
labs(title=p0("Time distribution per Event ", format(Sys.time(), "%Y-%m-%d")))
b <- ggplot(dataE, aes(note, SumDays))+
geom_bar(stat="identity")+
turnXaxis()+
coord_flip()+
orderX(data2[order(SumHours)]$note)+
xlab("Event")+
labs(title=p0("Days distribution per Event ", format(Sys.time(), "%Y-%m-%d"), " TT=", TTDays))
setwd(wd2)
printfast(a, "Event_hours.jpg", 600, 800)
printfast(b, "Event_days.jpg", 600, 800)
