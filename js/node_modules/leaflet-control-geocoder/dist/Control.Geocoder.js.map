{"version":3,"file":"Control.Geocoder.js","sources":["../src/geocoders/api.ts","../src/util.ts","../src/geocoders/arcgis.ts","../src/geocoders/bing.ts","../src/geocoders/google.ts","../src/geocoders/here.ts","../src/geocoders/latlng.ts","../src/geocoders/mapbox.ts","../src/geocoders/mapquest.ts","../src/geocoders/neutrino.ts","../src/geocoders/nominatim.ts","../src/geocoders/open-location-code.ts","../src/geocoders/opencage.ts","../src/geocoders/pelias.ts","../src/geocoders/photon.ts","../src/geocoders/what3words.ts","../src/control.ts","../src/index.ts"],"sourcesContent":["import * as L from 'leaflet';\n\n/**\n * An object that represents a result from a geocoding query\n */\nexport interface GeocodingResult {\n  /**\n   * Name of found location\n   */\n  name: string;\n  /**\n   * The bounds of the location\n   */\n  bbox: L.LatLngBounds;\n  /**\n   * The center coordinate of the location\n   */\n  center: L.LatLng;\n  /**\n   * URL for icon representing result; optional\n   */\n  icon?: string;\n  /**\n   * HTML formatted representation of the name\n   */\n  html?: string;\n  /**\n   * Additional properties returned by the geocoder\n   */\n  properties?: any;\n}\n\n/**\n * A callback function used in {@link IGeocoder.geocode} and {@link IGeocoder.suggest} and {@link IGeocoder.reverse}\n */\nexport type GeocodingCallback = (result: GeocodingResult[]) => void;\n\n/**\n * An interface implemented to respond to geocoding queries\n */\nexport interface IGeocoder {\n  /**\n   * Performs a geocoding query and returns the results to the callback in the provided context\n   * @param query the query\n   * @param cb the callback function\n   * @param context the `this` context in the callback\n   */\n  geocode(query: string, cb: GeocodingCallback, context?: any): void;\n  /**\n   * Performs a geocoding query suggestion (this happens while typing) and returns the results to the callback in the provided context\n   * @param query the query\n   * @param cb the callback function\n   * @param context the `this` context in the callback\n   */\n  suggest?(query: string, cb: GeocodingCallback, context?: any): void;\n  /**\n   * Performs a reverse geocoding query and returns the results to the callback in the provided context\n   * @param location the coordinate to reverse geocode\n   * @param scale the map scale possibly used for reverse geocoding\n   * @param cb the callback function\n   * @param context the `this` context in the callback\n   */\n  reverse?(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void;\n}\n\nexport interface GeocoderOptions {\n  /**\n   * URL of the service\n   */\n  serviceUrl: string;\n  /**\n   * Additional URL parameters (strings) that will be added to geocoding requests\n   */\n  geocodingQueryParams?: Record<string, unknown>;\n  /**\n   * Additional URL parameters (strings) that will be added to reverse geocoding requests\n   */\n  reverseQueryParams?: Record<string, unknown>;\n  /**\n   * API key to use this service\n   */\n  apiKey?: string;\n}\n\n/**\n * @internal\n */\nexport function geocodingParams(\n  options: GeocoderOptions,\n  params: Record<string, unknown>\n): Record<string, unknown> {\n  return L.Util.extend(params, options.geocodingQueryParams);\n}\n\n/**\n * @internal\n */\nexport function reverseParams(\n  options: GeocoderOptions,\n  params: Record<string, unknown>\n): Record<string, unknown> {\n  return L.Util.extend(params, options.reverseQueryParams);\n}\n","import * as L from 'leaflet';\n/**\n * @internal\n */\nlet lastCallbackId = 0;\n\n// Adapted from handlebars.js\n// https://github.com/wycats/handlebars.js/\n/**\n * @internal\n */\nconst badChars = /[&<>\"'`]/g;\n/**\n * @internal\n */\nconst possible = /[&<>\"'`]/;\n/**\n * @internal\n */\nconst escape: Record<string, string> = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;'\n};\n\n/**\n * @internal\n */\nfunction escapeChar(chr: string) {\n  return escape[chr];\n}\n\n/**\n * @internal\n */\nexport function htmlEscape(string?: string): string {\n  if (string == null) {\n    return '';\n  } else if (!string) {\n    return string + '';\n  }\n\n  // Force a string conversion as this will be done by the append regardless and\n  // the regex test will do this transparently behind the scenes, causing issues if\n  // an object's to string has escaped characters in it.\n  string = '' + string;\n\n  if (!possible.test(string)) {\n    return string;\n  }\n  return string.replace(badChars, escapeChar);\n}\n\n/**\n * @internal\n */\nexport function jsonp(\n  url: string,\n  params: Record<string, any>,\n  callback: (message: any) => void,\n  context: any,\n  jsonpParam?: string\n) {\n  const callbackId = '_l_geocoder_' + lastCallbackId++;\n  params[jsonpParam || 'callback'] = callbackId;\n  (window as any)[callbackId] = L.Util.bind(callback, context);\n  const script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.src = url + getParamString(params);\n  script.id = callbackId;\n  document.getElementsByTagName('head')[0].appendChild(script);\n}\n\n/**\n * @internal\n */\nexport function getJSON(\n  url: string,\n  params: Record<string, unknown>,\n  callback: (message: any) => void\n): void {\n  const xmlHttp = new XMLHttpRequest();\n  xmlHttp.onreadystatechange = function() {\n    if (xmlHttp.readyState !== 4) {\n      return;\n    }\n    let message;\n    if (xmlHttp.status !== 200 && xmlHttp.status !== 304) {\n      message = '';\n    } else if (typeof xmlHttp.response === 'string') {\n      // IE doesn't parse JSON responses even with responseType: 'json'.\n      try {\n        message = JSON.parse(xmlHttp.response);\n      } catch (e) {\n        // Not a JSON response\n        message = xmlHttp.response;\n      }\n    } else {\n      message = xmlHttp.response;\n    }\n    callback(message);\n  };\n  xmlHttp.open('GET', url + getParamString(params), true);\n  xmlHttp.responseType = 'json';\n  xmlHttp.setRequestHeader('Accept', 'application/json');\n  xmlHttp.send(null);\n}\n\n/**\n * @internal\n */\nexport function template(str: string, data: Record<string, any>): string {\n  return str.replace(/\\{ *([\\w_]+) *\\}/g, (str, key) => {\n    let value = data[key];\n    if (value === undefined) {\n      value = '';\n    } else if (typeof value === 'function') {\n      value = value(data);\n    }\n    return htmlEscape(value);\n  });\n}\n\n/**\n * @internal\n */\nexport function getParamString(\n  obj: Record<string, unknown | unknown[]>,\n  existingUrl?: string,\n  uppercase?: boolean\n): string {\n  const params = [];\n  for (const i in obj) {\n    const key = encodeURIComponent(uppercase ? i.toUpperCase() : i);\n    const value = obj[i];\n    if (!Array.isArray(value)) {\n      params.push(key + '=' + encodeURIComponent(String(value)));\n    } else {\n      for (let j = 0; j < value.length; j++) {\n        params.push(key + '=' + encodeURIComponent(value[j]));\n      }\n    }\n  }\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface ArcGisOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [ArcGIS geocoder](https://developers.arcgis.com/features/geocoding/)\n */\nexport class ArcGis implements IGeocoder {\n  options: ArcGisOptions = {\n    serviceUrl: 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer',\n    apiKey: ''\n  };\n\n  constructor(options?: Partial<ArcGisOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      token: this.options.apiKey,\n      SingleLine: query,\n      outFields: 'Addr_Type',\n      forStorage: false,\n      maxLocations: 10,\n      f: 'json'\n    });\n\n    getJSON(this.options.serviceUrl + '/findAddressCandidates', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.candidates && data.candidates.length) {\n        for (let i = 0; i <= data.candidates.length - 1; i++) {\n          const loc = data.candidates[i];\n          const latLng = L.latLng(loc.location.y, loc.location.x);\n          const latLngBounds = L.latLngBounds(\n            L.latLng(loc.extent.ymax, loc.extent.xmax),\n            L.latLng(loc.extent.ymin, loc.extent.xmin)\n          );\n          results[i] = {\n            name: loc.address,\n            bbox: latLngBounds,\n            center: latLng\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      location: encodeURIComponent(location.lng) + ',' + encodeURIComponent(location.lat),\n      distance: 100,\n      f: 'json'\n    });\n    getJSON(this.options.serviceUrl + '/reverseGeocode', params, data => {\n      const result: GeocodingResult[] = [];\n      if (data && !data.error) {\n        const center = L.latLng(data.location.y, data.location.x);\n        const bbox = L.latLngBounds(center, center);\n        result.push({\n          name: data.address.Match_addr,\n          center: center,\n          bbox: bbox\n        });\n      }\n\n      cb.call(context, result);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link ArcGis}\n * @param options the options\n */\nexport function arcgis(options?: Partial<ArcGisOptions>) {\n  return new ArcGis(options);\n}\n","import * as L from 'leaflet';\nimport { jsonp } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface BingOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [Bing Locations API](https://docs.microsoft.com/en-us/bingmaps/rest-services/locations/)\n */\nexport class Bing implements IGeocoder {\n  options: BingOptions = {\n    serviceUrl: 'https://dev.virtualearth.net/REST/v1/Locations'\n  };\n\n  constructor(options?: Partial<BingOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      query: query,\n      key: this.options.apiKey\n    });\n    jsonp(\n      this.options.apiKey,\n      params,\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.resourceSets.length > 0) {\n          for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\n            const resource = data.resourceSets[0].resources[i],\n              bbox = resource.bbox;\n            results[i] = {\n              name: resource.name,\n              bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\n              center: L.latLng(resource.point.coordinates)\n            };\n          }\n        }\n        cb.call(context, results);\n      },\n      this,\n      'jsonp'\n    );\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey\n    });\n    jsonp(\n      this.options.serviceUrl + location.lat + ',' + location.lng,\n      params,\n      data => {\n        const results: GeocodingResult[] = [];\n        for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\n          const resource = data.resourceSets[0].resources[i],\n            bbox = resource.bbox;\n          results[i] = {\n            name: resource.name,\n            bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\n            center: L.latLng(resource.point.coordinates)\n          };\n        }\n        cb.call(context, results);\n      },\n      this,\n      'jsonp'\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Bing}\n * @param options the options\n */\nexport function bing(options?: Partial<BingOptions>) {\n  return new Bing(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\n/**\n * Implementation of the [Google Geocoding API](https://developers.google.com/maps/documentation/geocoding/)\n */\nexport interface GoogleOptions extends GeocoderOptions {}\n\nexport class Google implements IGeocoder {\n  options: GoogleOptions = {\n    serviceUrl: 'https://maps.googleapis.com/maps/api/geocode/json'\n  };\n\n  constructor(options?: Partial<GoogleOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      key: this.options.apiKey,\n      address: query\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i <= data.results.length - 1; i++) {\n          const loc = data.results[i];\n          const latLng = L.latLng(loc.geometry.location);\n          const latLngBounds = L.latLngBounds(\n            L.latLng(loc.geometry.viewport.northeast),\n            L.latLng(loc.geometry.viewport.southwest)\n          );\n          results[i] = {\n            name: loc.formatted_address,\n            bbox: latLngBounds,\n            center: latLng,\n            properties: loc.address_components\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey,\n      latlng: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng)\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i <= data.results.length - 1; i++) {\n          const loc = data.results[i];\n          const center = L.latLng(loc.geometry.location);\n          const bbox = L.latLngBounds(\n            L.latLng(loc.geometry.viewport.northeast),\n            L.latLng(loc.geometry.viewport.southwest)\n          );\n          results[i] = {\n            name: loc.formatted_address,\n            bbox: bbox,\n            center: center,\n            properties: loc.address_components\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Google}\n * @param options the options\n */\nexport function google(options?: Partial<GoogleOptions>) {\n  return new Google(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface HereOptions extends GeocoderOptions {\n  /**\n   * Use `apiKey` and the new `HEREv2` geocoder\n   * @deprecated\n   */\n  app_id: string;\n  /**\n   * Use `apiKey` and the new `HEREv2` geocoder\n   * @deprecated\n   */\n  app_code: string;\n  reverseGeocodeProxRadius?: any;\n  apiKey: string;\n}\n\n/**\n * Implementation of the [HERE Geocoder API](https://developer.here.com/documentation/geocoder/topics/introduction.html)\n */\nexport class HERE implements IGeocoder {\n  options: HereOptions = {\n    serviceUrl: 'https://geocoder.api.here.com/6.2/',\n    app_id: '',\n    app_code: '',\n    apiKey: ''\n  };\n\n  constructor(options?: Partial<HereOptions>) {\n    L.Util.setOptions(this, options);\n    if (options.apiKey) throw Error('apiKey is not supported, use app_id/app_code instead!');\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      searchtext: query,\n      gen: 9,\n      app_id: this.options.app_id,\n      app_code: this.options.app_code,\n      jsonattributes: 1\n    });\n    this.getJSON(this.options.serviceUrl + 'geocode.json', params, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const _proxRadius = this.options.reverseGeocodeProxRadius\n      ? this.options.reverseGeocodeProxRadius\n      : null;\n    const proxRadius = _proxRadius ? ',' + encodeURIComponent(_proxRadius) : '';\n    const params = reverseParams(this.options, {\n      prox: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng) + proxRadius,\n      mode: 'retrieveAddresses',\n      app_id: this.options.app_id,\n      app_code: this.options.app_code,\n      gen: 9,\n      jsonattributes: 1\n    });\n    this.getJSON(this.options.serviceUrl + 'reversegeocode.json', params, cb, context);\n  }\n\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\n    getJSON(url, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.response.view && data.response.view.length) {\n        for (let i = 0; i <= data.response.view[0].result.length - 1; i++) {\n          const loc = data.response.view[0].result[i].location;\n          const center = L.latLng(loc.displayPosition.latitude, loc.displayPosition.longitude);\n          const bbox = L.latLngBounds(\n            L.latLng(loc.mapView.topLeft.latitude, loc.mapView.topLeft.longitude),\n            L.latLng(loc.mapView.bottomRight.latitude, loc.mapView.bottomRight.longitude)\n          );\n          results[i] = {\n            name: loc.address.label,\n            properties: loc.address,\n            bbox: bbox,\n            center: center\n          };\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * Implementation of the new [HERE Geocoder API](https://developer.here.com/documentation/geocoding-search-api/api-reference-swagger.html)\n */\nexport class HEREv2 implements IGeocoder {\n  options: HereOptions = {\n    serviceUrl: 'https://geocode.search.hereapi.com/v1',\n    apiKey: '',\n    app_id: '',\n    app_code: ''\n  };\n\n  constructor(options?: Partial<HereOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      q: query,\n      apiKey: this.options.apiKey\n    });\n\n    if (!params.at && !params.in) {\n      throw Error(\n        'at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.'\n      );\n    }\n\n    this.getJSON(this.options.serviceUrl + '/discover', params, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const _proxRadius = this.options.reverseGeocodeProxRadius\n      ? this.options.reverseGeocodeProxRadius\n      : null;\n    const proxRadius = _proxRadius ? ',' + encodeURIComponent(_proxRadius) : '';\n    const params = reverseParams(this.options, {\n      at: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng),\n      apiKey: this.options.apiKey\n    });\n\n    if (proxRadius) {\n      params.limit = proxRadius;\n    }\n\n    this.getJSON(this.options.serviceUrl + '/revgeocode', params, cb, context);\n  }\n\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\n    getJSON(url, params, data => {\n      const results: GeocodingResult[] = [];\n\n      if (data.items && data.items.length) {\n        for (let i = 0; i <= data.items.length - 1; i++) {\n          const item = data.items[i];\n          const latLng = L.latLng(item.position.lat, item.position.lng);\n          let bbox: L.LatLngBounds;\n          if (item.mapView) {\n            bbox = L.latLngBounds(\n              L.latLng(item.mapView.south, item.mapView.west),\n              L.latLng(item.mapView.north, item.mapView.east)\n            );\n          } else {\n            // Using only position when not provided\n            bbox = L.latLngBounds(\n              L.latLng(item.position.lat, item.position.lng),\n              L.latLng(item.position.lat, item.position.lng)\n            );\n          }\n          results[i] = {\n            name: item.address.label,\n            properties: item.address,\n            bbox: bbox,\n            center: latLng\n          };\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link HERE}\n * @param options the options\n */\nexport function here(options?: Partial<HereOptions>) {\n  if (options.apiKey) {\n    return new HEREv2(options);\n  } else {\n    return new HERE(options);\n  }\n}\n","import * as L from 'leaflet';\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\n\nexport interface LatLngOptions {\n  /**\n   * The next geocoder to use for non-supported queries\n   */\n  next?: IGeocoder;\n  /**\n   * The size in meters used for passing to `LatLng.toBounds`\n   */\n  sizeInMeters: number;\n}\n\n/**\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\n * @param query the latitude/longitude string to parse\n * @returns the parsed latitude/longitude\n */\nexport function parseLatLng(query: string): L.LatLng | undefined {\n  let match;\n  // regex from https://github.com/openstreetmap/openstreetmap-website/blob/master/app/controllers/geocoder_controller.rb\n  if ((match = query.match(/^([NS])\\s*(\\d{1,3}(?:\\.\\d*)?)\\W*([EW])\\s*(\\d{1,3}(?:\\.\\d*)?)$/))) {\n    // [NSEW] decimal degrees\n    return L.latLng(\n      (/N/i.test(match[1]) ? 1 : -1) * parseFloat(match[2]),\n      (/E/i.test(match[3]) ? 1 : -1) * parseFloat(match[4])\n    );\n  } else if (\n    (match = query.match(/^(\\d{1,3}(?:\\.\\d*)?)\\s*([NS])\\W*(\\d{1,3}(?:\\.\\d*)?)\\s*([EW])$/))\n  ) {\n    // decimal degrees [NSEW]\n    return L.latLng(\n      (/N/i.test(match[2]) ? 1 : -1) * parseFloat(match[1]),\n      (/E/i.test(match[4]) ? 1 : -1) * parseFloat(match[3])\n    );\n  } else if (\n    (match = query.match(\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?$/\n    ))\n  ) {\n    // [NSEW] degrees, decimal minutes\n    return L.latLng(\n      (/N/i.test(match[1]) ? 1 : -1) * (parseFloat(match[2]) + parseFloat(match[3]) / 60),\n      (/E/i.test(match[4]) ? 1 : -1) * (parseFloat(match[5]) + parseFloat(match[6]) / 60)\n    );\n  } else if (\n    (match = query.match(\n      /^(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([EW])$/\n    ))\n  ) {\n    // degrees, decimal minutes [NSEW]\n    return L.latLng(\n      (/N/i.test(match[3]) ? 1 : -1) * (parseFloat(match[1]) + parseFloat(match[2]) / 60),\n      (/E/i.test(match[6]) ? 1 : -1) * (parseFloat(match[4]) + parseFloat(match[5]) / 60)\n    );\n  } else if (\n    (match = query.match(\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?$/\n    ))\n  ) {\n    // [NSEW] degrees, minutes, decimal seconds\n    return L.latLng(\n      (/N/i.test(match[1]) ? 1 : -1) *\n        (parseFloat(match[2]) + parseFloat(match[3]) / 60 + parseFloat(match[4]) / 3600),\n      (/E/i.test(match[5]) ? 1 : -1) *\n        (parseFloat(match[6]) + parseFloat(match[7]) / 60 + parseFloat(match[8]) / 3600)\n    );\n  } else if (\n    (match = query.match(\n      /^(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\s*([EW])$/\n    ))\n  ) {\n    // degrees, minutes, decimal seconds [NSEW]\n    return L.latLng(\n      (/N/i.test(match[4]) ? 1 : -1) *\n        (parseFloat(match[1]) + parseFloat(match[2]) / 60 + parseFloat(match[3]) / 3600),\n      (/E/i.test(match[8]) ? 1 : -1) *\n        (parseFloat(match[5]) + parseFloat(match[6]) / 60 + parseFloat(match[7]) / 3600)\n    );\n  } else if ((match = query.match(/^\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*[\\s,]\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*$/))) {\n    return L.latLng(parseFloat(match[1]), parseFloat(match[2]));\n  }\n}\n\n/**\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\n */\nexport class LatLng implements IGeocoder {\n  options: LatLngOptions = {\n    next: undefined,\n    sizeInMeters: 10000\n  };\n\n  constructor(options?: Partial<LatLngOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\n    const center = parseLatLng(query);\n    if (center) {\n      const results: GeocodingResult[] = [\n        {\n          name: query,\n          center: center,\n          bbox: center.toBounds(this.options.sizeInMeters)\n        }\n      ];\n      cb.call(context, results);\n    } else if (this.options.next) {\n      this.options.next.geocode(query, cb, context);\n    }\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link LatLng}\n * @param options the options\n */\nexport function latLng(options?: Partial<LatLngOptions>) {\n  return new LatLng(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface MapboxOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [Mapbox Geocoding](https://www.mapbox.com/api-documentation/#geocoding)\n */\nexport class Mapbox implements IGeocoder {\n  options: MapboxOptions = {\n    serviceUrl: 'https://api.mapbox.com/geocoding/v5/mapbox.places/'\n  };\n\n  constructor(options?: Partial<MapboxOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  _getProperties(loc) {\n    const properties = {\n      text: loc.text,\n      address: loc.address\n    };\n\n    for (let j = 0; j < (loc.context || []).length; j++) {\n      const id = loc.context[j].id.split('.')[0];\n      properties[id] = loc.context[j].text;\n\n      // Get country code when available\n      if (loc.context[j].short_code) {\n        properties['countryShortCode'] = loc.context[j].short_code;\n      }\n    }\n    return properties;\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params: any = geocodingParams(this.options, {\n      access_token: this.options.apiKey\n    });\n    if (\n      params.proximity !== undefined &&\n      params.proximity.lat !== undefined &&\n      params.proximity.lng !== undefined\n    ) {\n      params.proximity = params.proximity.lng + ',' + params.proximity.lat;\n    }\n    getJSON(this.options.serviceUrl + encodeURIComponent(query) + '.json', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.features && data.features.length) {\n        for (let i = 0; i <= data.features.length - 1; i++) {\n          const loc = data.features[i];\n          const center = L.latLng(loc.center.reverse());\n          let bbox: L.LatLngBounds;\n          if (loc.bbox) {\n            bbox = L.latLngBounds(\n              L.latLng(loc.bbox.slice(0, 2).reverse()),\n              L.latLng(loc.bbox.slice(2, 4).reverse())\n            );\n          } else {\n            bbox = L.latLngBounds(center, center);\n          }\n\n          results[i] = {\n            name: loc.place_name,\n            bbox: bbox,\n            center: center,\n            properties: this._getProperties(loc)\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const param = reverseParams(this.options, {\n      access_token: this.options.apiKey\n    });\n    getJSON(\n      this.options.serviceUrl +\n        encodeURIComponent(location.lng) +\n        ',' +\n        encodeURIComponent(location.lat) +\n        '.json',\n      param,\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.features && data.features.length) {\n          for (let i = 0; i <= data.features.length - 1; i++) {\n            const loc = data.features[i];\n            const center = L.latLng(loc.center.reverse());\n            let bbox: L.LatLngBounds;\n            if (loc.bbox) {\n              bbox = L.latLngBounds(\n                L.latLng(loc.bbox.slice(0, 2).reverse()),\n                L.latLng(loc.bbox.slice(2, 4).reverse())\n              );\n            } else {\n              bbox = L.latLngBounds(center, center);\n            }\n            results[i] = {\n              name: loc.place_name,\n              bbox: bbox,\n              center: center,\n              properties: this._getProperties(loc)\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Mapbox}\n * @param options the options\n */\nexport function mapbox(options?: Partial<MapboxOptions>) {\n  return new Mapbox(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface MapQuestOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [MapQuest Geocoding API](http://developer.mapquest.com/web/products/dev-services/geocoding-ws)\n */\nexport class MapQuest implements IGeocoder {\n  options: MapQuestOptions = {\n    serviceUrl: 'https://www.mapquestapi.com/geocoding/v1'\n  };\n\n  constructor(options?: Partial<MapQuestOptions>) {\n    L.Util.setOptions(this, options);\n    // MapQuest seems to provide URI encoded API keys,\n    // so to avoid encoding them twice, we decode them here\n    this.options.apiKey = decodeURIComponent(this.options.apiKey);\n  }\n\n  _formatName(...parts: string[]) {\n    return parts.filter(s => !!s).join(', ');\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      key: this.options.apiKey,\n      location: query,\n      limit: 5,\n      outFormat: 'json'\n    });\n    getJSON(\n      this.options.serviceUrl + '/address',\n      params,\n      L.Util.bind(function(data) {\n        const results: GeocodingResult[] = [];\n        if (data.results && data.results[0].locations) {\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\n            const loc = data.results[0].locations[i];\n            const center = L.latLng(loc.latLng);\n            results[i] = {\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\n              bbox: L.latLngBounds(center, center),\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this)\n    );\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey,\n      location: location.lat + ',' + location.lng,\n      outputFormat: 'json'\n    });\n    getJSON(\n      this.options.serviceUrl + '/reverse',\n      params,\n      L.Util.bind(function(data) {\n        const results: GeocodingResult[] = [];\n        if (data.results && data.results[0].locations) {\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\n            const loc = data.results[0].locations[i];\n            const center = L.latLng(loc.latLng);\n            results[i] = {\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\n              bbox: L.latLngBounds(center, center),\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this)\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link MapQuest}\n * @param options the options\n */\nexport function mapQuest(options?: Partial<MapQuestOptions>) {\n  return new MapQuest(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface NeutrinoOptions extends GeocoderOptions {\n  userId: string;\n}\n\n/**\n * Implementation of the [Neutrino API](https://www.neutrinoapi.com/api/geocode-address/)\n */\nexport class Neutrino implements IGeocoder {\n  options: NeutrinoOptions = {\n    userId: undefined,\n    apiKey: undefined,\n    serviceUrl: 'https://neutrinoapi.com/'\n  };\n\n  constructor(options?: Partial<NeutrinoOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  // https://www.neutrinoapi.com/api/geocode-address/\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      apiKey: this.options.apiKey,\n      userId: this.options.userId,\n      //get three words and make a dot based string\n      address: query.split(/\\s+/).join('.')\n    });\n    getJSON(this.options.serviceUrl + 'geocode-address', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.locations) {\n        data.geometry = data.locations[0];\n        const center = L.latLng(data.geometry['latitude'], data.geometry['longitude']);\n        const bbox = L.latLngBounds(center, center);\n        results[0] = {\n          name: data.geometry.address,\n          bbox: bbox,\n          center: center\n        };\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  // https://www.neutrinoapi.com/api/geocode-reverse/\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      apiKey: this.options.apiKey,\n      userId: this.options.userId,\n      latitude: location.lat,\n      longitude: location.lng\n    });\n    getJSON(this.options.serviceUrl + 'geocode-reverse', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.status.status == 200 && data.found) {\n        const center = L.latLng(location.lat, location.lng);\n        const bbox = L.latLngBounds(center, center);\n        results[0] = {\n          name: data.address,\n          bbox: bbox,\n          center: center\n        };\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Neutrino}\n * @param options the options\n */\nexport function neutrino(options?: Partial<NeutrinoOptions>) {\n  return new Neutrino(options);\n}\n","import * as L from 'leaflet';\nimport { template, getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface NominatimResult {\n  place_id: number;\n  licence: string;\n  osm_type: string;\n  osm_id: number;\n  boundingbox: string[];\n  lat: string;\n  lon: string;\n  display_name: string;\n  class: string;\n  type: string;\n  importance: number;\n  icon?: string;\n  address: NominatimAddress;\n}\n\nexport interface NominatimAddress {\n  building?: string;\n  city_district?: string;\n  city?: string;\n  country_code?: string;\n  country?: string;\n  county?: string;\n  hamlet?: string;\n  house_number?: string;\n  neighbourhood?: string;\n  postcode?: string;\n  road?: string;\n  state_district?: string;\n  state?: string;\n  suburb?: string;\n  village?: string;\n}\n\nexport interface NominatimOptions extends GeocoderOptions {\n  /**\n   * Additional URL parameters (strings) that will be added to geocoding requests; can be used to restrict results to a specific country for example, by providing the [`countrycodes`](https://wiki.openstreetmap.org/wiki/Nominatim#Parameters) parameter to Nominatim\n   */\n  geocodingQueryParams?: Record<string, unknown>;\n  /**\n   * A function that takes an GeocodingResult as argument and returns an HTML formatted string that represents the result. Default function breaks up address in parts from most to least specific, in attempt to increase readability compared to Nominatim's naming\n   */\n  htmlTemplate: (r: NominatimResult) => string;\n}\n\n/**\n * Implementation of the [Nominatim](https://wiki.openstreetmap.org/wiki/Nominatim) geocoder.\n *\n * This is the default geocoding service used by the control, unless otherwise specified in the options.\n *\n * Unless using your own Nominatim installation, please refer to the [Nominatim usage policy](https://operations.osmfoundation.org/policies/nominatim/).\n */\nexport class Nominatim implements IGeocoder {\n  options: NominatimOptions = {\n    serviceUrl: 'https://nominatim.openstreetmap.org/',\n    htmlTemplate: function(r: NominatimResult) {\n      const address = r.address;\n      let className: string;\n      const parts = [];\n      if (address.road || address.building) {\n        parts.push('{building} {road} {house_number}');\n      }\n\n      if (address.city || (address as any).town || address.village || address.hamlet) {\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-detail' : '';\n        parts.push(\n          '<span class=\"' + className + '\">{postcode} {city} {town} {village} {hamlet}</span>'\n        );\n      }\n\n      if (address.state || address.country) {\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-context' : '';\n        parts.push('<span class=\"' + className + '\">{state} {country}</span>');\n      }\n\n      return template(parts.join('<br/>'), address);\n    }\n  };\n\n  constructor(options?: Partial<NominatimOptions>) {\n    L.Util.setOptions(this, options || {});\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\n    const params = geocodingParams(this.options, {\n      q: query,\n      limit: 5,\n      format: 'json',\n      addressdetails: 1\n    });\n    getJSON(this.options.serviceUrl + 'search', params, data => {\n      const results: GeocodingResult[] = [];\n      for (let i = data.length - 1; i >= 0; i--) {\n        const bbox = data[i].boundingbox;\n        for (let j = 0; j < 4; j++) bbox[j] = parseFloat(bbox[j]);\n        results[i] = {\n          icon: data[i].icon,\n          name: data[i].display_name,\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data[i]) : undefined,\n          bbox: L.latLngBounds([bbox[0], bbox[2]], [bbox[1], bbox[3]]),\n          center: L.latLng(data[i].lat, data[i].lon),\n          properties: data[i]\n        };\n      }\n      cb.call(context, results);\n    });\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\n    const params = reverseParams(this.options, {\n      lat: location.lat,\n      lon: location.lng,\n      zoom: Math.round(Math.log(scale / 256) / Math.log(2)),\n      addressdetails: 1,\n      format: 'json'\n    });\n    getJSON(this.options.serviceUrl + 'reverse', params, data => {\n      const result: GeocodingResult[] = [];\n      if (data && data.lat && data.lon) {\n        const center = L.latLng(data.lat, data.lon);\n        const bbox = L.latLngBounds(center, center);\n        result.push({\n          name: data.display_name,\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data) : undefined,\n          center: center,\n          bbox: bbox,\n          properties: data\n        });\n      }\n      cb.call(context, result);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Nominatim}\n * @param options the options\n */\nexport function nominatim(options?: Partial<NominatimOptions>) {\n  return new Nominatim(options);\n}\n","import * as L from 'leaflet';\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\n\nexport interface OpenLocationCodeOptions {\n  OpenLocationCode: OpenLocationCodeApi;\n  codeLength?: number;\n}\n\nexport interface OpenLocationCodeApi {\n  encode(latitude: number, longitude: number, codeLength?: number): string;\n  decode(code: string): CodeArea;\n}\n\nexport interface CodeArea {\n  latitudeLo: number;\n  longitudeLo: number;\n  latitudeHi: number;\n  longitudeHi: number;\n  latitudeCenter: number;\n  longitudeCenter: number;\n  codeLength: number;\n}\n\n/**\n * Implementation of the [Plus codes](https://plus.codes/) (formerly OpenLocationCode) (requires [open-location-code](https://www.npmjs.com/package/open-location-code))\n */\nexport class OpenLocationCode implements IGeocoder {\n  options: OpenLocationCodeOptions;\n  constructor(options?: Partial<OpenLocationCodeOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\n    try {\n      const decoded = this.options.OpenLocationCode.decode(query);\n      const result: GeocodingResult = {\n        name: query,\n        center: L.latLng(decoded.latitudeCenter, decoded.longitudeCenter),\n        bbox: L.latLngBounds(\n          L.latLng(decoded.latitudeLo, decoded.longitudeLo),\n          L.latLng(decoded.latitudeHi, decoded.longitudeHi)\n        )\n      };\n      cb.call(context, [result]);\n    } catch (e) {\n      console.warn(e); // eslint-disable-line no-console\n      cb.call(context, []);\n    }\n  }\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\n    try {\n      const code = this.options.OpenLocationCode.encode(\n        location.lat,\n        location.lng,\n        this.options.codeLength\n      );\n      const result = {\n        name: code,\n        center: L.latLng(location.lat, location.lng),\n        bbox: L.latLngBounds(\n          L.latLng(location.lat, location.lng),\n          L.latLng(location.lat, location.lng)\n        )\n      };\n      cb.call(context, [result]);\n    } catch (e) {\n      console.warn(e); // eslint-disable-line no-console\n      cb.call(context, []);\n    }\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link OpenLocationCode}\n * @param options the options\n */\nexport function openLocationCode(options?: Partial<OpenLocationCodeOptions>) {\n  return new OpenLocationCode(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface OpenCageOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [OpenCage Data API](https://opencagedata.com/)\n */\nexport class OpenCage implements IGeocoder {\n  options: OpenCageOptions = {\n    serviceUrl: 'https://api.opencagedata.com/geocode/v1/json'\n  };\n\n  constructor(options?: Partial<OpenCageOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      key: this.options.apiKey,\n      q: query\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i < data.results.length; i++) {\n          const loc = data.results[i];\n          const center = L.latLng(loc.geometry);\n          let bbox: L.LatLngBounds;\n          if (loc.annotations && loc.annotations.bounds) {\n            bbox = L.latLngBounds(\n              L.latLng(loc.annotations.bounds.northeast),\n              L.latLng(loc.annotations.bounds.southwest)\n            );\n          } else {\n            bbox = L.latLngBounds(center, center);\n          }\n          results.push({\n            name: loc.formatted,\n            bbox: bbox,\n            center: center\n          });\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey,\n      q: [location.lat, location.lng].join(',')\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i < data.results.length; i++) {\n          const loc = data.results[i];\n          const center = L.latLng(loc.geometry);\n          let bbox: L.LatLngBounds;\n          if (loc.annotations && loc.annotations.bounds) {\n            bbox = L.latLngBounds(\n              L.latLng(loc.annotations.bounds.northeast),\n              L.latLng(loc.annotations.bounds.southwest)\n            );\n          } else {\n            bbox = L.latLngBounds(center, center);\n          }\n          results.push({\n            name: loc.formatted,\n            bbox: bbox,\n            center: center\n          });\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\nexport function opencage(options?: Partial<OpenCageOptions>) {\n  return new OpenCage(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface PeliasOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [Pelias](https://pelias.io/), [geocode.earth](https://geocode.earth/) geocoder (formerly Mapzen Search)\n */\nexport class Pelias implements IGeocoder {\n  options: PeliasOptions = {\n    serviceUrl: 'https://api.geocode.earth/v1'\n  };\n\n  private _lastSuggest = 0;\n\n  constructor(options?: Partial<PeliasOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      api_key: this.options.apiKey,\n      text: query\n    });\n    getJSON(this.options.serviceUrl + '/search', params, data => {\n      cb.call(context, this._parseResults(data, 'bbox'));\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      api_key: this.options.apiKey,\n      text: query\n    });\n    getJSON(this.options.serviceUrl + '/autocomplete', params, data => {\n      if (data.geocoding.timestamp > this._lastSuggest) {\n        this._lastSuggest = data.geocoding.timestamp;\n        cb.call(context, this._parseResults(data, 'bbox'));\n      }\n    });\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      api_key: this.options.apiKey,\n      'point.lat': location.lat,\n      'point.lon': location.lng\n    });\n    getJSON(this.options.serviceUrl + '/reverse', params, data => {\n      cb.call(context, this._parseResults(data, 'bounds'));\n    });\n  }\n\n  _parseResults(data, bboxname) {\n    const results: GeocodingResult[] = [];\n    L.geoJSON(data, {\n      pointToLayer: function(feature, latlng) {\n        return L.circleMarker(latlng);\n      },\n      onEachFeature: function(feature, layer: any) {\n        const result = {} as GeocodingResult;\n        let bbox;\n        let center;\n\n        if (layer.getBounds) {\n          bbox = layer.getBounds();\n          center = bbox.getCenter();\n        } else if (layer.feature.bbox) {\n          center = layer.getLatLng();\n          bbox = L.latLngBounds(\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(0, 2)),\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(2, 4))\n          );\n        } else {\n          center = layer.getLatLng();\n          bbox = L.latLngBounds(center, center);\n        }\n\n        result.name = layer.feature.properties.label;\n        result.center = center;\n        result[bboxname] = bbox;\n        result.properties = layer.feature.properties;\n        results.push(result);\n      }\n    });\n    return results;\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Pelias}\n * @param options the options\n */\nexport function pelias(options?: Partial<PeliasOptions>) {\n  return new Pelias(options);\n}\n\nexport const GeocodeEarth = Pelias;\nexport const geocodeEarth = pelias;\n\n/**\n * r.i.p.\n * @deprecated\n */\nexport const Mapzen = Pelias;\n/**\n * r.i.p.\n * @deprecated\n */\nexport const mapzen = pelias;\n\n/**\n * Implementation of the [Openrouteservice](https://openrouteservice.org/dev/#/api-docs/geocode) geocoder\n */\nexport class Openrouteservice extends Pelias {\n  constructor(options?: Partial<PeliasOptions>) {\n    super(\n      L.Util.extend(\n        {\n          serviceUrl: 'https://api.openrouteservice.org/geocode'\n        },\n        options\n      )\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Openrouteservice}\n * @param options the options\n */\nexport function openrouteservice(options?: Partial<PeliasOptions>) {\n  return new Openrouteservice(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface PhotonOptions extends GeocoderOptions {\n  reverseUrl: string;\n  nameProperties: string[];\n  htmlTemplate?: (r: any) => string;\n}\n\n/**\n * Implementation of the [Photon](http://photon.komoot.de/) geocoder\n */\nexport class Photon implements IGeocoder {\n  options: PhotonOptions = {\n    serviceUrl: 'https://photon.komoot.io/api/',\n    reverseUrl: 'https://photon.komoot.io/reverse/',\n    nameProperties: ['name', 'street', 'suburb', 'hamlet', 'town', 'city', 'state', 'country']\n  };\n\n  constructor(options?: Partial<PhotonOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, { q: query });\n    getJSON(\n      this.options.serviceUrl,\n      params,\n      L.Util.bind(function(data) {\n        cb.call(context, this._decodeFeatures(data));\n      }, this)\n    );\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(latLng: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      lat: latLng.lat,\n      lon: latLng.lng\n    });\n    getJSON(\n      this.options.reverseUrl,\n      params,\n      L.Util.bind(function(data) {\n        cb.call(context, this._decodeFeatures(data));\n      }, this)\n    );\n  }\n\n  _decodeFeatures(data: GeoJSON.FeatureCollection<GeoJSON.Point>) {\n    const results: GeocodingResult[] = [];\n\n    if (data && data.features) {\n      for (let i = 0; i < data.features.length; i++) {\n        const f = data.features[i];\n        const c = f.geometry.coordinates;\n        const center = L.latLng(c[1], c[0]);\n        const extent = f.properties.extent;\n\n        const bbox = extent\n          ? L.latLngBounds([extent[1], extent[0]], [extent[3], extent[2]])\n          : L.latLngBounds(center, center);\n\n        results.push({\n          name: this._decodeFeatureName(f),\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(f) : undefined,\n          center: center,\n          bbox: bbox,\n          properties: f.properties\n        });\n      }\n    }\n\n    return results;\n  }\n\n  _decodeFeatureName(f: GeoJSON.Feature) {\n    return (this.options.nameProperties || [])\n      .map(p => {\n        return f.properties[p];\n      })\n      .filter(v => {\n        return !!v;\n      })\n      .join(', ');\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Photon}\n * @param options the options\n */\nexport function photon(options?: Partial<PhotonOptions>) {\n  return new Photon(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface What3WordsOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the What3Words service\n */\nexport class What3Words implements IGeocoder {\n  options: What3WordsOptions = {\n    serviceUrl: 'https://api.what3words.com/v2/'\n  };\n\n  constructor(options: Partial<What3WordsOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    //get three words and make a dot based string\n    getJSON(\n      this.options.serviceUrl + 'forward',\n      geocodingParams(this.options, {\n        key: this.options.apiKey,\n        addr: query.split(/\\s+/).join('.')\n      }),\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.geometry) {\n          const latLng = L.latLng(data.geometry['lat'], data.geometry['lng']);\n          const latLngBounds = L.latLngBounds(latLng, latLng);\n          results[0] = {\n            name: data.words,\n            bbox: latLngBounds,\n            center: latLng\n          };\n        }\n\n        cb.call(context, results);\n      }\n    );\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    getJSON(\n      this.options.serviceUrl + 'reverse',\n      reverseParams(this.options, {\n        key: this.options.apiKey,\n        coords: [location.lat, location.lng].join(',')\n      }),\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.status.status == 200) {\n          const center = L.latLng(data.geometry['lat'], data.geometry['lng']);\n          const bbox = L.latLngBounds(center, center);\n          results[0] = {\n            name: data.words,\n            bbox: bbox,\n            center: center\n          };\n        }\n        cb.call(context, results);\n      }\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link What3Words}\n * @param options the options\n */\nexport function what3words(options: Partial<What3WordsOptions>) {\n  return new What3Words(options);\n}\n","import * as L from 'leaflet';\nimport { Nominatim } from './geocoders/index';\nimport { IGeocoder, GeocodingResult } from './geocoders/api';\n\nexport interface GeocoderControlOptions extends L.ControlOptions {\n  /**\n   * Collapse control unless hovered/clicked\n   */\n  collapsed: boolean;\n  /**\n   * How to expand a collapsed control: `touch` or `click` or `hover`\n   */\n  expand: 'touch' | 'click' | 'hover';\n  /**\n   * Placeholder text for text input\n   */\n  placeholder: string;\n  /**\n   * Message when no result found / geocoding error occurs\n   */\n  errorMessage: string;\n  /**\n   * Accessibility label for the search icon used by screen readers\n   */\n  iconLabel: string;\n  /**\n   * Object to perform the actual geocoding queries\n   */\n  geocoder?: IGeocoder;\n  /**\n   * Immediately show the unique result without prompting for alternatives\n   */\n  showUniqueResult: boolean;\n  /**\n   * Show icons for geocoding results (if available); supported by Nominatim\n   */\n  showResultIcons: boolean;\n  /**\n   * Minimum number characters before suggest functionality is used (if available from geocoder)\n   */\n  suggestMinLength: number;\n  /**\n   * Number of milliseconds after typing stopped before suggest functionality is used (if available from geocoder)\n   */\n  suggestTimeout: number;\n  /**\n   * Initial query string for text input\n   */\n  query: string;\n  /**\n   * Minimum number of characters in search text before performing a query\n   */\n  queryMinLength: number;\n  /**\n   * Whether to mark a geocoding result on the map by default\n   */\n  defaultMarkGeocode: boolean;\n}\n\n\n/**\n * Leaflet mixins https://leafletjs.com/reference-1.7.1.html#class-includes\n * for TypeScript https://www.typescriptlang.org/docs/handbook/mixins.html\n * @internal\n */\nclass EventedControl {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(...args: any[]) {\n    // empty\n  }\n}\n\n/**\n * @internal\n */\ninterface EventedControl extends L.Control, L.Evented {}\nL.Util.extend(EventedControl.prototype, L.Control.prototype);\nL.Util.extend(EventedControl.prototype, L.Evented.prototype);\n\n/**\n * This is the geocoder control. It works like any other [Leaflet control](https://leafletjs.com/reference.html#control), and is added to the map.\n */\nexport class GeocoderControl extends EventedControl {\n  options: GeocoderControlOptions = {\n    showUniqueResult: true,\n    showResultIcons: false,\n    collapsed: true,\n    expand: 'touch',\n    position: 'topright',\n    placeholder: 'Search...',\n    errorMessage: 'Nothing found.',\n    iconLabel: 'Initiate a new search',\n    query: '',\n    queryMinLength: 1,\n    suggestMinLength: 3,\n    suggestTimeout: 250,\n    defaultMarkGeocode: true\n  };\n\n  private _alts: HTMLUListElement;\n  private _container: HTMLDivElement;\n  private _errorElement: HTMLDivElement;\n  private _form: HTMLDivElement;\n  private _geocodeMarker: L.Marker;\n  private _input: HTMLInputElement;\n  private _lastGeocode: string;\n  private _map: L.Map;\n  private _preventBlurCollapse: boolean;\n  private _requestCount = 0;\n  private _results: any;\n  private _selection: any;\n  private _suggestTimeout: any;\n\n  /**\n   * Instantiates a geocoder control (to be invoked using `new`)\n   * @param options the options\n   */\n  constructor(options?: Partial<GeocoderControlOptions>) {\n    super(options);\n    L.Util.setOptions(this, options);\n    if (!this.options.geocoder) {\n      this.options.geocoder = new Nominatim();\n    }\n  }\n\n  addThrobberClass() {\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-throbber');\n  }\n\n  removeThrobberClass() {\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-throbber');\n  }\n\n  /**\n   * Returns the container DOM element for the control and add listeners on relevant map events.\n   * @param map the map instance\n   * @see https://leafletjs.com/reference.html#control-onadd\n   */\n  onAdd(map: L.Map) {\n    const className = 'leaflet-control-geocoder';\n    const container = L.DomUtil.create('div', className + ' leaflet-bar') as HTMLDivElement;\n    const icon = L.DomUtil.create('button', className + '-icon', container) as HTMLButtonElement;\n    const form = (this._form = L.DomUtil.create(\n      'div',\n      className + '-form',\n      container\n    ) as HTMLDivElement);\n\n    this._map = map;\n    this._container = container;\n\n    icon.innerHTML = '&nbsp;';\n    icon.type = 'button';\n    icon.setAttribute('aria-label', this.options.iconLabel);\n\n    const input = (this._input = L.DomUtil.create('input', '', form) as HTMLInputElement);\n    input.type = 'text';\n    input.value = this.options.query;\n    input.placeholder = this.options.placeholder;\n    L.DomEvent.disableClickPropagation(input);\n\n    this._errorElement = L.DomUtil.create(\n      'div',\n      className + '-form-no-error',\n      container\n    ) as HTMLDivElement;\n    this._errorElement.innerHTML = this.options.errorMessage;\n\n    this._alts = L.DomUtil.create(\n      'ul',\n      className + '-alternatives leaflet-control-geocoder-alternatives-minimized',\n      container\n    ) as HTMLUListElement;\n    L.DomEvent.disableClickPropagation(this._alts);\n\n    L.DomEvent.addListener(input, 'keydown', this._keydown, this);\n    if (this.options.geocoder.suggest) {\n      L.DomEvent.addListener(input, 'input', this._change, this);\n    }\n    L.DomEvent.addListener(input, 'blur', () => {\n      if (this.options.collapsed && !this._preventBlurCollapse) {\n        this._collapse();\n      }\n      this._preventBlurCollapse = false;\n    });\n\n    if (this.options.collapsed) {\n      if (this.options.expand === 'click') {\n        L.DomEvent.addListener(container, 'click', (e: Event) => {\n          if ((e as MouseEvent).button === 0 && (e as MouseEvent).detail !== 2) {\n            this._toggle();\n          }\n        });\n      } else if (this.options.expand === 'touch') {\n        L.DomEvent.addListener(\n          container,\n          L.Browser.touch ? 'touchstart mousedown' : 'mousedown',\n          (e: Event) => {\n            this._toggle();\n            e.preventDefault(); // mobile: clicking focuses the icon, so UI expands and immediately collapses\n            e.stopPropagation();\n          },\n          this\n        );\n      } else {\n        L.DomEvent.addListener(container, 'mouseover', this._expand, this);\n        L.DomEvent.addListener(container, 'mouseout', this._collapse, this);\n        this._map.on('movestart', this._collapse, this);\n      }\n    } else {\n      this._expand();\n      if (L.Browser.touch) {\n        L.DomEvent.addListener(container, 'touchstart', () => this._geocode());\n      } else {\n        L.DomEvent.addListener(container, 'click', () => this._geocode());\n      }\n    }\n\n    if (this.options.defaultMarkGeocode) {\n      this.on('markgeocode', this.markGeocode as any, this);\n    }\n\n    this.on('startgeocode', this.addThrobberClass, this);\n    this.on('finishgeocode', this.removeThrobberClass, this);\n    this.on('startsuggest', this.addThrobberClass, this);\n    this.on('finishsuggest', this.removeThrobberClass, this);\n\n    L.DomEvent.disableClickPropagation(container);\n\n    return container;\n  }\n\n  /**\n   * Sets the query string on the text input\n   * @param string the query string\n   */\n  setQuery(string: string): this {\n    this._input.value = string;\n    return this;\n  }\n\n  private _geocodeResult(results: GeocodingResult[], suggest: boolean) {\n    if (!suggest && this.options.showUniqueResult && results.length === 1) {\n      this._geocodeResultSelected(results[0]);\n    } else if (results.length > 0) {\n      this._alts.innerHTML = '';\n      this._results = results;\n      L.DomUtil.removeClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-open');\n      for (let i = 0; i < results.length; i++) {\n        this._alts.appendChild(this._createAlt(results[i], i));\n      }\n    } else {\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-error');\n      L.DomUtil.addClass(this._errorElement, 'leaflet-control-geocoder-error');\n    }\n  }\n\n  /**\n   * Marks a geocoding result on the map\n   * @param result the geocoding result\n   */\n  markGeocode(result: GeocodingResult) {\n    result = (result as any).geocode || result;\n\n    this._map.fitBounds(result.bbox);\n\n    if (this._geocodeMarker) {\n      this._map.removeLayer(this._geocodeMarker);\n    }\n\n    this._geocodeMarker = new L.Marker(result.center)\n      .bindPopup(result.html || result.name)\n      .addTo(this._map)\n      .openPopup();\n\n    return this;\n  }\n\n  private _geocode(suggest?: boolean) {\n    const value = this._input.value;\n    if (!suggest && value.length < this.options.queryMinLength) {\n      return;\n    }\n\n    const requestCount = ++this._requestCount;\n    const cb = (results: GeocodingResult[]) => {\n      if (requestCount === this._requestCount) {\n        this.fire(suggest ? 'finishsuggest' : 'finishgeocode', { input: value, results });\n        this._geocodeResult(results, suggest);\n      }\n    };\n\n    this._lastGeocode = value;\n    if (!suggest) {\n      this._clearResults();\n    }\n\n    this.fire(suggest ? 'startsuggest' : 'startgeocode', { input: value });\n    if (suggest) {\n      this.options.geocoder.suggest(value, cb);\n    } else {\n      this.options.geocoder.geocode(value, cb);\n    }\n  }\n\n  private _geocodeResultSelected(result: GeocodingResult) {\n    this.fire('markgeocode', { geocode: result });\n  }\n\n  private _toggle() {\n    if (L.DomUtil.hasClass(this._container, 'leaflet-control-geocoder-expanded')) {\n      this._collapse();\n    } else {\n      this._expand();\n    }\n  }\n\n  private _expand() {\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-expanded');\n    this._input.select();\n    this.fire('expand');\n  }\n\n  private _collapse() {\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-expanded');\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\n    this._input.blur(); // mobile: keyboard shouldn't stay expanded\n    this.fire('collapse');\n  }\n\n  private _clearResults() {\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n    this._selection = null;\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\n  }\n\n  private _createAlt(result: GeocodingResult, index: number) {\n    const li = L.DomUtil.create('li', ''),\n      a = L.DomUtil.create('a', '', li),\n      icon =\n        this.options.showResultIcons && result.icon\n          ? (L.DomUtil.create('img', '', a) as HTMLImageElement)\n          : null,\n      text = result.html ? undefined : document.createTextNode(result.name),\n      mouseDownHandler = (e: Event) => {\n        // In some browsers, a click will fire on the map if the control is\n        // collapsed directly after mousedown. To work around this, we\n        // wait until the click is completed, and _then_ collapse the\n        // control. Messy, but this is the workaround I could come up with\n        // for #142.\n        this._preventBlurCollapse = true;\n        L.DomEvent.stop(e);\n        this._geocodeResultSelected(result);\n        L.DomEvent.on(li, 'click touchend', () => {\n          if (this.options.collapsed) {\n            this._collapse();\n          } else {\n            this._clearResults();\n          }\n        });\n      };\n\n    if (icon) {\n      icon.src = result.icon;\n    }\n\n    li.setAttribute('data-result-index', String(index));\n\n    if (result.html) {\n      a.innerHTML = a.innerHTML + result.html;\n    } else if (text) {\n      a.appendChild(text);\n    }\n\n    // Use mousedown and not click, since click will fire _after_ blur,\n    // causing the control to have collapsed and removed the items\n    // before the click can fire.\n    L.DomEvent.addListener(li, 'mousedown touchstart', mouseDownHandler, this);\n\n    return li;\n  }\n\n  private _keydown(e: KeyboardEvent) {\n    const select = (dir: number) => {\n      if (this._selection) {\n        L.DomUtil.removeClass(this._selection, 'leaflet-control-geocoder-selected');\n        this._selection = this._selection[dir > 0 ? 'nextSibling' : 'previousSibling'];\n      }\n      if (!this._selection) {\n        this._selection = this._alts[dir > 0 ? 'firstChild' : 'lastChild'];\n      }\n\n      if (this._selection) {\n        L.DomUtil.addClass(this._selection, 'leaflet-control-geocoder-selected');\n      }\n    };\n\n    switch (e.keyCode) {\n      // Escape\n      case 27:\n        if (this.options.collapsed) {\n          this._collapse();\n        } else {\n          this._clearResults();\n        }\n        break;\n      // Up\n      case 38:\n        select(-1);\n        break;\n      // Up\n      case 40:\n        select(1);\n        break;\n      // Enter\n      case 13:\n        if (this._selection) {\n          const index = parseInt(this._selection.getAttribute('data-result-index'), 10);\n          this._geocodeResultSelected(this._results[index]);\n          this._clearResults();\n        } else {\n          this._geocode();\n        }\n        break;\n      default:\n        return;\n    }\n\n    L.DomEvent.preventDefault(e);\n  }\n\n  private _change() {\n    const v = this._input.value;\n    if (v !== this._lastGeocode) {\n      clearTimeout(this._suggestTimeout);\n      if (v.length >= this.options.suggestMinLength) {\n        this._suggestTimeout = setTimeout(() => this._geocode(true), this.options.suggestTimeout);\n      } else {\n        this._clearResults();\n      }\n    }\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link GeocoderControl}\n * @param options the options\n */\nexport function geocoder(options?: Partial<GeocoderControlOptions>) {\n  return new GeocoderControl(options);\n}\n","/* @preserve\n * Leaflet Control Geocoder\n * https://github.com/perliedman/leaflet-control-geocoder\n *\n * Copyright (c) 2012 sa3m (https://github.com/sa3m)\n * Copyright (c) 2018 Per Liedman\n * All rights reserved.\n */\nimport * as L from 'leaflet';\nimport { GeocoderControl as Geocoder, geocoder } from './control';\nimport * as geocoders from './geocoders/index';\n\nL.Util.extend(Geocoder, geocoders);\nexport default Geocoder;\n\nL.Util.extend(L.Control, {\n  Geocoder: Geocoder,\n  geocoder: geocoder\n});\n"],"names":["geocodingParams","options","params","L","extend","geocodingQueryParams","reverseParams","reverseQueryParams","lastCallbackId","badChars","possible","escape","escapeChar","chr","htmlEscape","string","test","replace","jsonp","url","callback","context","jsonpParam","callbackId","window","bind","script","document","createElement","type","src","getParamString","id","getElementsByTagName","appendChild","getJSON","xmlHttp","XMLHttpRequest","onreadystatechange","readyState","message","status","response","JSON","parse","e","open","responseType","setRequestHeader","send","template","str","data","key","value","undefined","obj","existingUrl","uppercase","i","encodeURIComponent","toUpperCase","Array","isArray","push","String","j","length","indexOf","join","ArcGis","serviceUrl","apiKey","setOptions","geocode","query","cb","token","SingleLine","outFields","forStorage","maxLocations","f","results","candidates","loc","latLng","location","y","x","latLngBounds","extent","ymax","xmax","ymin","xmin","name","address","bbox","center","call","suggest","reverse","scale","lng","lat","distance","result","error","Match_addr","arcgis","Bing","resourceSets","resources","resource","point","coordinates","bing","Google","geometry","viewport","northeast","southwest","formatted_address","properties","address_components","latlng","google","HERE","app_id","app_code","Error","searchtext","gen","jsonattributes","_proxRadius","reverseGeocodeProxRadius","proxRadius","prox","mode","view","displayPosition","latitude","longitude","mapView","topLeft","bottomRight","label","HEREv2","q","at","limit","items","item","position","south","west","north","east","here","parseLatLng","match","parseFloat","LatLng","next","sizeInMeters","toBounds","Mapbox","_getProperties","text","split","short_code","access_token","proximity","features","slice","place_name","param","mapbox","MapQuest","decodeURIComponent","_formatName","filter","s","outFormat","locations","street","adminArea4","adminArea3","adminArea1","outputFormat","mapQuest","Neutrino","userId","found","neutrino","Nominatim","htmlTemplate","r","className","parts","road","building","city","town","village","hamlet","state","country","format","addressdetails","boundingbox","icon","display_name","html","lon","zoom","Math","round","log","nominatim","OpenLocationCode","decoded","decode","latitudeCenter","longitudeCenter","latitudeLo","longitudeLo","latitudeHi","longitudeHi","console","warn","code","encode","codeLength","openLocationCode","OpenCage","annotations","bounds","formatted","opencage","Pelias","api_key","_parseResults","geocoding","timestamp","_lastSuggest","bboxname","pointToLayer","feature","onEachFeature","layer","getBounds","getCenter","getLatLng","coordsToLatLng","pelias","GeocodeEarth","geocodeEarth","Mapzen","mapzen","Openrouteservice","openrouteservice","Photon","reverseUrl","nameProperties","_decodeFeatures","c","_decodeFeatureName","map","p","v","photon","What3Words","addr","words","coords","what3words","EventedControl","prototype","GeocoderControl","showUniqueResult","showResultIcons","collapsed","expand","placeholder","errorMessage","iconLabel","queryMinLength","suggestMinLength","suggestTimeout","defaultMarkGeocode","geocoder","addThrobberClass","addClass","_container","removeThrobberClass","removeClass","onAdd","container","create","form","_form","_map","innerHTML","setAttribute","input","_input","disableClickPropagation","_errorElement","_alts","addListener","_keydown","_change","_preventBlurCollapse","_collapse","button","detail","_toggle","touch","preventDefault","stopPropagation","_expand","on","_geocode","markGeocode","setQuery","_geocodeResult","_geocodeResultSelected","_results","_createAlt","fitBounds","_geocodeMarker","removeLayer","bindPopup","addTo","openPopup","requestCount","_requestCount","fire","_lastGeocode","_clearResults","hasClass","select","blur","_selection","index","li","a","createTextNode","mouseDownHandler","stop","dir","keyCode","parseInt","getAttribute","clearTimeout","_suggestTimeout","setTimeout","Geocoder","geocoders"],"mappings":"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"}